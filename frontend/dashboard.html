<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A2A Security Dashboard - 대시보드</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/d3@7/dist/d3.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
    <script src="dashboard.js" defer></script>
  </head>
  <body>
    <div class="app-container" data-page="dashboard">
      <header class="app-header">
        <div class="logo">A2A SECURE</div>
        <nav class="main-nav">
          <a href="dashboard.html" class="nav-link active">대시보드</a>
          <a href="agents/agents.html" class="nav-link">에이전트</a>
          <a href="logs/logs.html" class="nav-link">로그</a>
          <a href="ruleset/ruleset.html" class="nav-link">룰셋</a>
        </nav>
      </header>

      <main class="content-area">
        <div class="content-wrapper">
          <header class="dashboard-header">
            <div class="dashboard-header__text">
              <h1>보안 운영 현황</h1>
              <p>에이전트 흐름, 정책 로그, 트래픽 상태를 실시간으로 확인합니다.</p>
            </div>
            <div class="dashboard-header__actions">
              <button class="btn-secondary" id="refresh-dashboard">전체 새로고침</button>
            </div>
          </header>

          <section class="dashboard-layout">
            <article class="widget dashboard-card span-8" data-card="flow">
              <div class="widget-header-with-button">
                <div>
                  <h2 class="widget-title">에이전트 흐름</h2>
                  <p class="widget-subtitle">연결 관계와 정책 적용 현황</p>
                </div>
                <div class="widget-actions">
                  <span class="pill pill-live" id="flow-status">동기화 중…</span>
                  <button class="btn-secondary" id="refresh-flow">그래프 새로고침</button>
                </div>
              </div>
              <div class="card-body">
                <div class="graph-shell">
                  <div id="graph-tooltip" class="graph-tooltip hidden"></div>
                  <svg id="agent-flow-graph" role="presentation"></svg>
                </div>
              </div>
            </article>

            <article class="widget dashboard-card span-4" data-card="stats">
              <div class="widget-header-with-button">
                <div>
                  <h2 class="widget-title">운영 지표</h2>
                  <p class="widget-subtitle">등록 현황과 위험 지수</p>
                </div>
              </div>
              <div class="card-body">
                <div class="stat-grid">
                  <div class="stat-card">
                    <span class="label">총 에이전트</span>
                    <span class="value" id="total-agents">0</span>
                  </div>
                  <div class="stat-card">
                    <span class="label">총 룰셋</span>
                    <span class="value" id="total-rulesets">0</span>
                  </div>
                  <div class="stat-card">
                    <span class="label">정책 위반 (24시간)</span>
                    <span class="value" id="total-violations">0</span>
                  </div>
                  <div class="stat-card">
                    <span class="label">수집된 이벤트</span>
                    <span class="value" id="total-events">0</span>
                  </div>
                </div>
                <div class="risk-meter" id="risk-indicator">
                  <div class="risk-label">위험 지수</div>
                  <div class="risk-score" id="risk-score">--</div>
                  <div class="risk-bar">
                    <div class="risk-bar-fill" id="risk-bar-fill"></div>
                  </div>
                </div>
              </div>
            </article>

            <article class="widget dashboard-card span-6" data-card="traffic">
              <div class="widget-header-with-button">
                <div>
                  <h2 class="widget-title">이벤트 활동</h2>
                  <p class="widget-subtitle">최근 60분 이벤트와 위반 추이</p>
                </div>
                <div class="widget-actions">
                  <span class="pill" id="chart-range">최근 60분</span>
                </div>
              </div>
              <div class="card-body">
                <div class="chart-shell">
                  <canvas id="events-chart"></canvas>
                </div>
              </div>
            </article>

            <article class="widget dashboard-card span-6" data-card="agents">
              <div class="widget-header-with-button">
                <div>
                  <h2 class="widget-title">에이전트 상태</h2>
                  <p class="widget-subtitle">가동 중인 에이전트와 정책 위반</p>
                </div>
                <div class="widget-actions">
                  <a class="btn-secondary" href="agents/agents.html">에이전트 관리</a>
                </div>
              </div>
              <div class="card-body">
                <ul class="agent-status-list" id="agent-status-list"></ul>
              </div>
            </article>

            <article class="widget dashboard-card span-12" data-card="logs">
              <div class="widget-header-with-button">
                <div>
                  <h2 class="widget-title">최근 정책 로그</h2>
                  <p class="widget-subtitle">실시간 정책 결과와 메시지</p>
                </div>
                <div class="widget-actions">
                  <a class="btn-primary" href="logs/logs.html">로그 탐색기 열기</a>
                </div>
              </div>
              <div class="card-body">
                <div class="log-list" id="dashboard-log-list"></div>
              </div>
            </article>
          </section>
        </div>
      </main>
    </div>
  </body>
</html>
